<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Docker Build Stage Security Best Practices" /><meta name="author" content="Dazzy Ddos" /><meta property="og:locale" content="en_US" /><meta name="description" content="Introduction Hi Dear Readers, hope you all are safe and doing good. So, I welcome you all to the blog post on Docker Build Stage Security Best Practices. The title might be confusing to many since in this blog post we won’t be looking at attacking or pentesting Docker Containers but we’ll look at defences and best practices to protect docker containers from security issues. We’ll be discussing various security best practices such as Avoiding root user accounts, Copying only the needed files, Use of multi staged builds and many more. We’ll be gradually improving our Dockerfile and build a docker image with better security by the end of this post. This blog post actually was my notes that I prepared while doing the Course by @srini0x00. The link to the Course will be listed below the post. If you want a detail explanation of each topic covered in this blog, I would totally recommend to look at his course. So, without further a do, let’s begin the post." /><meta property="og:description" content="Introduction Hi Dear Readers, hope you all are safe and doing good. So, I welcome you all to the blog post on Docker Build Stage Security Best Practices. The title might be confusing to many since in this blog post we won’t be looking at attacking or pentesting Docker Containers but we’ll look at defences and best practices to protect docker containers from security issues. We’ll be discussing various security best practices such as Avoiding root user accounts, Copying only the needed files, Use of multi staged builds and many more. We’ll be gradually improving our Dockerfile and build a docker image with better security by the end of this post. This blog post actually was my notes that I prepared while doing the Course by @srini0x00. The link to the Course will be listed below the post. If you want a detail explanation of each topic covered in this blog, I would totally recommend to look at his course. So, without further a do, let’s begin the post." /><link rel="canonical" href="https://dazzyddos.github.io/posts/Docker-Build-Stage-Security-Best-Practices/" /><meta property="og:url" content="https://dazzyddos.github.io/posts/Docker-Build-Stage-Security-Best-Practices/" /><meta property="og:site_name" content="Dazzy Ddos" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-04-04T09:10:00+03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Docker Build Stage Security Best Practices" /><meta name="twitter:site" content="@dazzyddos" /><meta name="twitter:creator" content="@Dazzy Ddos" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Dazzy Ddos"},"description":"Introduction Hi Dear Readers, hope you all are safe and doing good. So, I welcome you all to the blog post on Docker Build Stage Security Best Practices. The title might be confusing to many since in this blog post we won’t be looking at attacking or pentesting Docker Containers but we’ll look at defences and best practices to protect docker containers from security issues. We’ll be discussing various security best practices such as Avoiding root user accounts, Copying only the needed files, Use of multi staged builds and many more. We’ll be gradually improving our Dockerfile and build a docker image with better security by the end of this post. This blog post actually was my notes that I prepared while doing the Course by @srini0x00. The link to the Course will be listed below the post. If you want a detail explanation of each topic covered in this blog, I would totally recommend to look at his course. So, without further a do, let’s begin the post.","url":"https://dazzyddos.github.io/posts/Docker-Build-Stage-Security-Best-Practices/","@type":"BlogPosting","headline":"Docker Build Stage Security Best Practices","dateModified":"2021-04-05T07:23:33+03:00","datePublished":"2021-04-04T09:10:00+03:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://dazzyddos.github.io/posts/Docker-Build-Stage-Security-Best-Practices/"},"@context":"https://schema.org"}</script><title>Docker Build Stage Security Best Practices | Dazzy Ddos</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/25081660?s=460&u=d7eb9a459d672ab9b0b1ccead34de3233e2843ee&v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Dazzy Ddos</a></div><div class="site-subtitle font-italic"></div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/dazzyddos" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/dazzyddos" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Docker Build Stage Security Best Practices</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Docker Build Stage Security Best Practices</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Apr 4, 2021, 9:10 AM +0300" > Apr 4, 2021 <i class="unloaded">2021-04-04T09:10:00+03:00</i> </span> by <span class="author"> Dazzy Ddos </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Apr 5, 2021, 9:53 AM +0530" > Apr 5, 2021 <i class="unloaded">2021-04-05T07:23:33+03:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2488 words">13 min</span></div></div><div class="post-content"><h2 id="introduction">Introduction</h2><p>Hi Dear Readers, hope you all are safe and doing good. So, I welcome you all to the blog post on <strong>Docker Build Stage Security Best Practices</strong>. The title might be confusing to many since in this blog post we won’t be looking at attacking or pentesting Docker Containers but we’ll look at defences and best practices to protect docker containers from security issues. We’ll be discussing various security best practices such as <strong>Avoiding root user accounts</strong>, <strong>Copying only the needed files</strong>, <strong>Use of multi staged builds</strong> and many more. We’ll be gradually improving our <em>Dockerfile</em> and build a docker image with better security by the end of this post. This blog post actually was my notes that I prepared while doing the Course by <em>@srini0x00</em>. The link to the Course will be listed below the post. If you want a detail explanation of each topic covered in this blog, I would totally recommend to look at his course. So, without further a do, let’s begin the post. <br /></p><h2 id="introduction-to-docker-containers">Introduction to Docker Containers</h2><p>I will not be delving deep into what is a docker or how it works but will give you very short brief idea about it. There used to be one time when developers had to face a lot of dependency issues. Their code would work totally fine on their computer but the same program would break when run on different computer. The answer is obvious that the dependencies or libraries the other computer is using is not necessarily same as the one on which the program was built. So, the <em>docker</em> addresses this issue. Docker allows us to wrap our code, dependencies, libraries, files or anything that’s required by the program inside a container and this container is portable. The other computers are only required to have docker installed in order to run this container. It might sound like <strong>Virtual Machine</strong> but there’s notable difference aside from the fact that docker containers are very light weight in comparison to the virtual machines. I believe the below image would be enough to clear the difference between them, If not please do some more research on it.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/dazzyddos/dazzyddos.github.io/master/Images/DockerBuildSec/vmvsdocker.jpg" alt="" /> **Source: ** https://www.weave.works/blog/a-practical-guide-to-choosing-between-docker-containers-and-vms</p><p><br /></p><h2 id="lab-setup-and-docker-installation">Lab Setup and Docker Installation</h2><p>By now I am assuming that you all are ready with your Linux instance. In my case I’ll be using <strong>Kali LInux 2021</strong> but you can use any linux machine. We’ll be installing Docker and bulid our basic non-secure docker image. Most of you might already have docker installed. I’ll be referring the official docker documentation to follow the installation steps and I recommend the same to all of you. You can select your version of linux from the link and follow the steps accordingly. https://docs.docker.com/engine/install/ In my case, It’ll be <strong>Debian</strong>. First let’s check if we’ve docker already installed by typing docker in the command line. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/dazzyddos/dazzyddos.github.io/master/Images/DockerBuildSec/Pasted%20image%2020210404171225.png" alt="" /></p><p>As can be seen, it’s not installed for me. If you have it installed and want to install it again from the beginning, you can uninstall it by:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>sudo apt-get remove docker docker-engine docker.io containerd runc
</pre></table></code></div></div><p>According to the documentation, first I must update my apt repository.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>sudo apt-get update
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/dazzyddos/dazzyddos.github.io/master/Images/DockerBuildSec/Pasted%20image%2020210404171726.png" alt="" /></p><p>You can also directly install docker from the apt repository.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>sudo apt-get install -y docker.io
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/dazzyddos/dazzyddos.github.io/master/Images/DockerBuildSec/Pasted%20image%2020210404172946.png" alt="" /></p><p>Once you have installed Docker, you can run:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker run hello-world
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/dazzyddos/dazzyddos.github.io/master/Images/DockerBuildSec/Pasted%20image%2020210404173125.png" alt="" /></p><p>Now we know that docker has been successfully installed on our machine and now we can proceed further. We are running docker commands as the root user. If we want to run docker being any other user, we must add him/her to Docker group.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>usermod -aG docker dazzy
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/dazzyddos/dazzyddos.github.io/master/Images/DockerBuildSec/Pasted%20image%2020210404173549.png" alt="" /></p><p>Here I added myself(dazzy) to the <em>docker</em> group and now I can run docker commands without having to put sudo before each command.</p><p><br /></p><h2 id="need-for-build-security">Need for Build Security</h2><p>When building a docker image, we use a file named <strong>Dockerfile</strong> which contains all the build instructions. Once the image is built, Containers are launched from these images. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/dazzyddos/dazzyddos.github.io/master/Images/DockerBuildSec/Pasted%20image%2020210404174246.png" alt="" /></p><p>Apologies for my drawing :P Many people think that containers are the ones that need to be protected. However, the security starts from the <em>Dockerfile</em> itself. When writing these Dockerfiles, we have to maintain security hygiene. It is important for developers to follow security best practices to avoid any security pitfalls in running containers.</p><p><br /></p><h2 id="building-a-basic-docker-image">Building a Basic Docker Image</h2><p>We are going to write a simple API in python-flask, a Dockerfile to write the build instructions and will finally build the image and run it.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">request</span>
<span class="kn">import</span> <span class="nn">subprocess</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">"/encode"</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">"GET"</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">encode_data</span><span class="p">():</span>
    <span class="n">user_input</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">args</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'input'</span><span class="p">)</span>
    <span class="n">command</span> <span class="o">=</span> <span class="s">'echo'</span> <span class="o">+</span> <span class="n">user_input</span> <span class="o">+</span> <span class="s">'| base64'</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">check_output</span><span class="p">([</span><span class="n">command</span><span class="p">],</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">app</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s">'0.0.0.0'</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8080</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/dazzyddos/dazzyddos.github.io/master/Images/DockerBuildSec/Pasted%20image%2020210404175931.png" alt="" /></p><p>Many of you might already be like “Wait a minute, why are you making us write a vulnerable python API program”. Yeah Yeah, you are correct. It’s only to explain the security measures that we’ll be looking at later. If you don’t know what this program does, it takes user input from the API endpoint <em>/encode</em> using the GET parameter <em>input</em> and passes that input to the command which encodes our user input to base64 encoding format and then we are passing it to subprocess’s check_output method which executes the command which is also including our user input.</p><p>Since it’s a flask api, we also need to install the Flask package. We’ll create a <em>requirements.txt</em> file and put the package name there and will ask pip to install the package we need.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/dazzyddos/dazzyddos.github.io/master/Images/DockerBuildSec/Pasted%20image%2020210404180928.png" alt="" /></p><p>Let’s now create our <em>Dockerfile</em>. Since we’ll be creating multiple <em>Dockerfiles</em>, I will be naming them <em>Dockerfile1</em>, <em>Dockerfile2</em> and so on since there’s no restriction on the naming. Let’s build our first <em>Dockerfile</em>: <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/dazzyddos/dazzyddos.github.io/master/Images/DockerBuildSec/Pasted%20image%2020210404183311.png" alt="" /> ***</p><blockquote><ul><li><p>In the first line, we are specifying the base image on top of which our application will be packaged. Since this is a python3 application, we are going to use python3 base image.</p><li><p>The second line is just the description for Dockerfile.</p><li><p>Third line is to create a virtual python environment. The main purpose of the virtual environment in python is to create virtualized environment for python projects. We can run any system commands using <strong>RUN</strong>.</p><li><p>In Fourth line, we are setting environment variable PATH to also include the python’s virtual environment path we just created above.</p><li><p>In Fifth line, we are creating a directory named /app inside container where we’ll place our code and files associated with it.</p><li><p>In Sixth line, we are copying <em>api.py</em> and <em>requirements.txt</em> from the current directory to the container image’s /app folder so that the dependency like Flask can be installed at runtime.</p><li><p>In Seventh line, we are changing our current working directory inside container image to /app directory.</p><li>In eight line, we are running pip3 to install the package names inside the requirements.txt file.<li>In tenth line, we are specying our entrypoint i.e., to run python3<li>In eleventh line, we are specifying the arguments to our entrypoing program i.e., <em>api.py</em> code.</ul></blockquote><p>Let’s now build this image.</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">docker</span> <span class="n">build</span> <span class="o">-</span><span class="n">f</span> <span class="n">Dockerfile1</span> <span class="o">-</span><span class="n">t</span> <span class="n">api</span><span class="o">:</span><span class="n">v1</span> <span class="p">.</span>
<span class="c1">// we are specifying the tag named api:v1 to the image </span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/dazzyddos/dazzyddos.github.io/master/Images/DockerBuildSec/Pasted%20image%2020210404183722.png" alt="" /> [..snip..]</p><p>To see if our image build was successfull, we can run <code class="language-plaintext highlighter-rouge">docker images</code> to see available images. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/dazzyddos/dazzyddos.github.io/master/Images/DockerBuildSec/Pasted%20image%2020210404183851.png" alt="" /></p><p>So our build was successfull. We finally created our first Docker image. This docker image we build is not fully secure and can be more improvized which we’ll be see going forward.</p><p><br /></p><h2 id="the-use-of-root-accounts">The use of root accounts</h2><p>When a container is started, a root user account will be available within the container by default. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/dazzyddos/dazzyddos.github.io/master/Images/DockerBuildSec/Pasted%20image%2020210404184740.png" alt="" /></p><p>Even though these accounts on Docker container do not come with all the capabilities that a traditional root user has, It is recommended to use a non-root user within a container. One way to avoid this is to specify <strong>–user</strong> flag with Docker command to use a non-root user within a container. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/dazzyddos/dazzyddos.github.io/master/Images/DockerBuildSec/Pasted%20image%2020210404184854.png" alt="" /></p><p>Another way is to specify <em>USER</em> command inside the <em>Dockerfile</em> itself. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/dazzyddos/dazzyddos.github.io/master/Images/DockerBuildSec/Pasted%20image%2020210404185235.png" alt="" /></p><p>So we solved this problem during the build stage itself.</p><p>Our python program is currently running as inside the container. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/dazzyddos/dazzyddos.github.io/master/Images/DockerBuildSec/Pasted%20image%2020210404185616.png" alt="" /></p><p>So, anyone who compromises our program will have root access to the container. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/dazzyddos/dazzyddos.github.io/master/Images/DockerBuildSec/Pasted%20image%2020210404190307.png" alt="" /></p><p>So let’s fix this in our <em>Dockerfile</em>. We’ll be creating a second <em>Dockerfile</em> which will avoid running the container as root user. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/dazzyddos/dazzyddos.github.io/master/Images/DockerBuildSec/Pasted%20image%2020210404190715.png" alt="" /></p><p>In our new <em>Dockerfile</em>, we created a user named user and gave him the ownership to the /app directory and gave 755 permission to the /app directory and then changed the user context of the container image.</p><p>Let’s now build this image. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/dazzyddos/dazzyddos.github.io/master/Images/DockerBuildSec/Pasted%20image%2020210404190927.png" alt="" /> [..snip..]</p><p>Let’s now run this container image. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/dazzyddos/dazzyddos.github.io/master/Images/DockerBuildSec/Pasted%20image%2020210404191119.png" alt="" /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/dazzyddos/dazzyddos.github.io/master/Images/DockerBuildSec/Pasted%20image%2020210404191407.png" alt="" /></p><p>As can be seen, now it doesn’t give the root user anymore.</p><p><br /></p><h2 id="copy-only-what-is-needed">COPY only what is needed</h2><p>As we saw, the <strong>COPY</strong> command is used to get the contents onto the image’s directory. One commonly seen practice is copying everything in the current directory onto docker image.</p><div class="language-markdown highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>COPY . /app
</pre></table></code></div></div><p>This can be risky especially when the current directory has some sensitive files such as secrets or backup files. It is also possible that we may copy files onto container which are not needed such as the <em>Dockerfile</em>. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/dazzyddos/dazzyddos.github.io/master/Images/DockerBuildSec/Pasted%20image%2020210404192328.png" alt="" /></p><p>Copying such unnecessaries files onto the container image can increase the file size of the final image.</p><p>Let’s fix our <em>Dockerfile</em> to only copy the file that’s needed. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/dazzyddos/dazzyddos.github.io/master/Images/DockerBuildSec/Pasted%20image%2020210404192744.png" alt="" /> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/dazzyddos/dazzyddos.github.io/master/Images/DockerBuildSec/Pasted%20image%2020210404192808.png" alt="" /> [..snip..]</p><p>Let’s now run the container image. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://raw.githubusercontent.com/dazzyddos/dazzyddos.github.io/master/Images/DockerBuildSec/Pasted%20image%2020210404192923.png" alt="" /></p><p>As can be seen that this time our Dockerfiles were not copied. Those files were only copied which we explicitly specified. <br /></p><h2 id="dangers-of-using-add-command">Dangers of using ADD Command</h2><p>ADD and COPY commands are used to achieve similar goal i.e., get content while building the image. COPY can only copy files from local directory but ADD can be used to additionally download a content from URL during the build time. Content maybe loaded from an untrusted source. It can also lead to broken builds especially if the URL used with the ADD command is not available anymore or the link is broken. <br /></p><h2 id="avoid-untrusted-base-images">Avoid untrusted base images</h2><p>The <strong>FROM</strong> command gets the base image while building custom images.</p><div class="language-markdown highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>FROM alpine:latest
</pre></table></code></div></div><p>if the image is being pulled from an untrusted resource, most likely the image may contain vulnerabilities or backdoored code. It’s best practice to avoid pulling images from untrusted sources.</p><p>Docker Hub provides official images of the msot popular OS - Ubuntu, CentOS.</p><div class="language-markdown highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>https://hub.docker.com/search?image_filter=official&amp;type=image
</pre></table></code></div></div><p>Official images are trusted and free from malicious behavior and Security Updates are applied in timely manner for them.</p><p><br /></p><h2 id="use-minimal-base-images">Use Minimal base images</h2><p>As we saw that the <strong>FROM</strong> command is used to get the base image on top of which our base image will be built. When images are built using dockerfile, it’s recommended to use base image with minimum tools and utilities. If we can, it’s better to use scratch images. As large number of tools and libraries will not be present in the contaner, it’ll automatically minimize the attack surface.</p><p>We can see the list of programs installed inside our container image.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>/app <span class="nv">$ </span><span class="nb">ls</span> /usr/bin
<span class="o">[</span>            cmp          <span class="nb">expr         head         </span>lzma         openvt       reset        ssl_client   ttysize      vlock
<span class="o">[[</span>           <span class="nb">comm         factor       </span>hexdump      lzopcat      passwd       resize       strings      udhcpc6      volname
<span class="nb">awk          </span>cpio         fallocate    <span class="nb">hostid       md5sum       paste        </span>scanelf      <span class="nb">sum          unexpand     wc
basename     </span>crontab      find         iconv        mesg         pgrep        <span class="nb">seq          tac          uniq         </span>wget
bc           cryptpw      flock        <span class="nb">id           </span>microcom     pinentry     setkeycodes  <span class="nb">tail         </span>unix2dos     which
beep         <span class="nb">cut          fold         install      mkfifo       </span>pkill        setsid       <span class="nb">tee          unlink       whoami
</span>blkdiscard   dc           free         ipcrm        mkpasswd     pmap         <span class="nb">sha1sum      test         </span>unlzma       whois
bunzip2      deallocvt    fuser        ipcs         nc           posixtz      <span class="nb">sha256sum    time         </span>unlzop       xargs
bzcat        diff         gdbm_dump    killall      <span class="nb">nl           printf       </span>sha3sum      <span class="nb">timeout      </span>unshare      xmlwf
bzip2        <span class="nb">dirname      </span>gdbm_load    ldd          nmeter       pscan        <span class="nb">sha512sum    </span>top          unxz         xxd
c_rehash     dos2unix     gdbmtool     less         <span class="nb">nohup        </span>pstree       showkey      <span class="nb">tr           </span>unzip        xzcat
cal          <span class="nb">du           </span>getconf      logger       <span class="nb">nproc        </span>pwdx         <span class="nb">shred        </span>traceroute   <span class="nb">uptime       yes
</span>chvt         eject        getent       lsof         nsenter      <span class="nb">readlink     shuf         </span>traceroute6  uudecode
<span class="nb">cksum        env          groups       </span>lsusb        nslookup     <span class="nb">realpath     sort         truncate     </span>uuencode
clear        <span class="nb">expand       </span>hd           lzcat        <span class="nb">od           </span>renice       <span class="nb">split        tty          </span>vi
/app <span class="nv">$ </span>
</pre></table></code></div></div><p>As can be seen, there are many programs that are not needed for this specific case since there’s no shell interaction needed for our python api program.</p><p>We can also see the list of installed packages on alpine image.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre><span class="o">/</span><span class="n">app</span> <span class="err">$</span> <span class="n">apk</span> <span class="nb">list</span>
<span class="n">WARNING</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">dl</span><span class="o">-</span><span class="n">cdn</span><span class="p">.</span><span class="n">alpinelinux</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="n">alpine</span><span class="o">/</span><span class="n">v3</span><span class="p">.</span><span class="mi">13</span><span class="o">/</span><span class="n">main</span><span class="p">:</span> <span class="n">No</span> <span class="n">such</span> <span class="nb">file</span> <span class="ow">or</span> <span class="n">directory</span>
<span class="n">WARNING</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">dl</span><span class="o">-</span><span class="n">cdn</span><span class="p">.</span><span class="n">alpinelinux</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="n">alpine</span><span class="o">/</span><span class="n">v3</span><span class="p">.</span><span class="mi">13</span><span class="o">/</span><span class="n">community</span><span class="p">:</span> <span class="n">No</span> <span class="n">such</span> <span class="nb">file</span> <span class="ow">or</span> <span class="n">directory</span>
<span class="n">sqlite</span><span class="o">-</span><span class="n">libs</span><span class="o">-</span><span class="mf">3.34</span><span class="p">.</span><span class="mi">1</span><span class="o">-</span><span class="n">r0</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">sqlite</span><span class="p">}</span> <span class="p">(</span><span class="n">Public</span><span class="o">-</span><span class="n">Domain</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">krb5</span><span class="o">-</span><span class="n">libs</span><span class="o">-</span><span class="mf">1.18</span><span class="p">.</span><span class="mi">3</span><span class="o">-</span><span class="n">r1</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">krb5</span><span class="p">}</span> <span class="p">(</span><span class="n">MIT</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">musl</span><span class="o">-</span><span class="mf">1.2</span><span class="p">.</span><span class="mi">2</span><span class="o">-</span><span class="n">r0</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">musl</span><span class="p">}</span> <span class="p">(</span><span class="n">MIT</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">libbz2</span><span class="o">-</span><span class="mf">1.0</span><span class="p">.</span><span class="mi">8</span><span class="o">-</span><span class="n">r1</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">bzip2</span><span class="p">}</span> <span class="p">(</span><span class="n">bzip2</span><span class="o">-</span><span class="mf">1.0</span><span class="p">.</span><span class="mi">6</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">libcom_err</span><span class="o">-</span><span class="mf">1.45</span><span class="p">.</span><span class="mi">7</span><span class="o">-</span><span class="n">r0</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">e2fsprogs</span><span class="p">}</span> <span class="p">(</span><span class="n">GPL</span><span class="o">-</span><span class="mf">2.0</span><span class="o">-</span><span class="ow">or</span><span class="o">-</span><span class="n">later</span> <span class="n">AND</span> <span class="n">LGPL</span><span class="o">-</span><span class="mf">2.0</span><span class="o">-</span><span class="ow">or</span><span class="o">-</span><span class="n">later</span> <span class="n">AND</span> <span class="n">BSD</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="n">Clause</span> <span class="n">AND</span> <span class="n">MIT</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">gdbm</span><span class="o">-</span><span class="mf">1.19</span><span class="o">-</span><span class="n">r0</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">gdbm</span><span class="p">}</span> <span class="p">(</span><span class="n">GPL</span><span class="o">-</span><span class="mf">3.0</span><span class="o">-</span><span class="ow">or</span><span class="o">-</span><span class="n">later</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">libtirpc</span><span class="o">-</span><span class="n">conf</span><span class="o">-</span><span class="mf">1.3</span><span class="p">.</span><span class="mi">1</span><span class="o">-</span><span class="n">r0</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">libtirpc</span><span class="p">}</span> <span class="p">(</span><span class="n">BSD</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="n">Clause</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">tzdata</span><span class="o">-</span><span class="mi">2021</span><span class="n">a</span><span class="o">-</span><span class="n">r0</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">tzdata</span><span class="p">}</span> <span class="p">(</span><span class="n">Public</span><span class="o">-</span><span class="n">Domain</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">ncurses</span><span class="o">-</span><span class="n">libs</span><span class="o">-</span><span class="mf">6.2</span><span class="n">_p20210109</span><span class="o">-</span><span class="n">r0</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">ncurses</span><span class="p">}</span> <span class="p">(</span><span class="n">MIT</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">zlib</span><span class="o">-</span><span class="mf">1.2</span><span class="p">.</span><span class="mi">11</span><span class="o">-</span><span class="n">r3</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">zlib</span><span class="p">}</span> <span class="p">(</span><span class="n">Zlib</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">keyutils</span><span class="o">-</span><span class="n">libs</span><span class="o">-</span><span class="mf">1.6</span><span class="p">.</span><span class="mi">3</span><span class="o">-</span><span class="n">r0</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">keyutils</span><span class="p">}</span> <span class="p">(</span><span class="n">GPL</span><span class="o">-</span><span class="mf">2.0</span><span class="o">-</span><span class="ow">or</span><span class="o">-</span><span class="n">later</span> <span class="n">LGPL</span><span class="o">-</span><span class="mf">2.0</span><span class="o">-</span><span class="ow">or</span><span class="o">-</span><span class="n">later</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">apk</span><span class="o">-</span><span class="n">tools</span><span class="o">-</span><span class="mf">2.12</span><span class="p">.</span><span class="mi">4</span><span class="o">-</span><span class="n">r0</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">apk</span><span class="o">-</span><span class="n">tools</span><span class="p">}</span> <span class="p">(</span><span class="n">GPL</span><span class="o">-</span><span class="mf">2.0</span><span class="o">-</span><span class="n">only</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">libintl</span><span class="o">-</span><span class="mf">0.20</span><span class="p">.</span><span class="mi">2</span><span class="o">-</span><span class="n">r2</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">gettext</span><span class="p">}</span> <span class="p">(</span><span class="n">LGPL</span><span class="o">-</span><span class="mf">2.1</span><span class="o">-</span><span class="ow">or</span><span class="o">-</span><span class="n">later</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">readline</span><span class="o">-</span><span class="mf">8.1</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="n">r0</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">readline</span><span class="p">}</span> <span class="p">(</span><span class="n">GPL</span><span class="o">-</span><span class="mf">2.0</span><span class="o">-</span><span class="ow">or</span><span class="o">-</span><span class="n">later</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">musl</span><span class="o">-</span><span class="n">utils</span><span class="o">-</span><span class="mf">1.2</span><span class="p">.</span><span class="mi">2</span><span class="o">-</span><span class="n">r0</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">musl</span><span class="p">}</span> <span class="p">(</span><span class="n">MIT</span> <span class="n">BSD</span> <span class="n">GPL2</span><span class="o">+</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">libssl1</span><span class="p">.</span><span class="mi">1</span><span class="o">-</span><span class="mf">1.1</span><span class="p">.</span><span class="mi">1</span><span class="n">k</span><span class="o">-</span><span class="n">r0</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">openssl</span><span class="p">}</span> <span class="p">(</span><span class="n">OpenSSL</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">ncurses</span><span class="o">-</span><span class="n">terminfo</span><span class="o">-</span><span class="n">base</span><span class="o">-</span><span class="mf">6.2</span><span class="n">_p20210109</span><span class="o">-</span><span class="n">r0</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">ncurses</span><span class="p">}</span> <span class="p">(</span><span class="n">MIT</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">alpine</span><span class="o">-</span><span class="n">baselayout</span><span class="o">-</span><span class="mf">3.2</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="n">r8</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">alpine</span><span class="o">-</span><span class="n">baselayout</span><span class="p">}</span> <span class="p">(</span><span class="n">GPL</span><span class="o">-</span><span class="mf">2.0</span><span class="o">-</span><span class="n">only</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">xz</span><span class="o">-</span><span class="n">libs</span><span class="o">-</span><span class="mf">5.2</span><span class="p">.</span><span class="mi">5</span><span class="o">-</span><span class="n">r0</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">xz</span><span class="p">}</span> <span class="p">(</span><span class="n">GPL</span><span class="o">-</span><span class="mf">2.0</span><span class="o">-</span><span class="ow">or</span><span class="o">-</span><span class="n">later</span> <span class="n">AND</span> <span class="n">Public</span><span class="o">-</span><span class="n">Domain</span> <span class="n">AND</span> <span class="n">LGPL</span><span class="o">-</span><span class="mf">2.1</span><span class="o">-</span><span class="ow">or</span><span class="o">-</span><span class="n">later</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">ca</span><span class="o">-</span><span class="n">certificates</span><span class="o">-</span><span class="mi">20191127</span><span class="o">-</span><span class="n">r5</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">ca</span><span class="o">-</span><span class="n">certificates</span><span class="p">}</span> <span class="p">(</span><span class="n">MPL</span><span class="o">-</span><span class="mf">2.0</span> <span class="n">AND</span> <span class="n">MIT</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">libverto</span><span class="o">-</span><span class="mf">0.3</span><span class="p">.</span><span class="mi">1</span><span class="o">-</span><span class="n">r1</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">libverto</span><span class="p">}</span> <span class="p">(</span><span class="n">MIT</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">alpine</span><span class="o">-</span><span class="n">keys</span><span class="o">-</span><span class="mf">2.2</span><span class="o">-</span><span class="n">r0</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">alpine</span><span class="o">-</span><span class="n">keys</span><span class="p">}</span> <span class="p">(</span><span class="n">MIT</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">libnsl</span><span class="o">-</span><span class="mf">1.3</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="n">r0</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">libnsl</span><span class="p">}</span> <span class="p">(</span><span class="n">LGPL</span><span class="o">-</span><span class="mf">2.0</span><span class="o">-</span><span class="ow">or</span><span class="o">-</span><span class="n">later</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">busybox</span><span class="o">-</span><span class="mf">1.32</span><span class="p">.</span><span class="mi">1</span><span class="o">-</span><span class="n">r5</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">busybox</span><span class="p">}</span> <span class="p">(</span><span class="n">GPL</span><span class="o">-</span><span class="mf">2.0</span><span class="o">-</span><span class="n">only</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">libuuid</span><span class="o">-</span><span class="mf">2.36</span><span class="p">.</span><span class="mi">1</span><span class="o">-</span><span class="n">r1</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">util</span><span class="o">-</span><span class="n">linux</span><span class="p">}</span> <span class="p">(</span><span class="n">GPL</span><span class="o">-</span><span class="mf">3.0</span><span class="o">-</span><span class="ow">or</span><span class="o">-</span><span class="n">later</span> <span class="n">AND</span> <span class="n">GPL</span><span class="o">-</span><span class="mf">2.0</span><span class="o">-</span><span class="ow">or</span><span class="o">-</span><span class="n">later</span> <span class="n">AND</span> <span class="n">GPL</span><span class="o">-</span><span class="mf">2.0</span><span class="o">-</span><span class="n">only</span> <span class="n">AND</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">libtirpc</span><span class="o">-</span><span class="mf">1.3</span><span class="p">.</span><span class="mi">1</span><span class="o">-</span><span class="n">r0</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">libtirpc</span><span class="p">}</span> <span class="p">(</span><span class="n">BSD</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="n">Clause</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">scanelf</span><span class="o">-</span><span class="mf">1.2</span><span class="p">.</span><span class="mi">8</span><span class="o">-</span><span class="n">r0</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">pax</span><span class="o">-</span><span class="n">utils</span><span class="p">}</span> <span class="p">(</span><span class="n">GPL</span><span class="o">-</span><span class="mf">2.0</span><span class="o">-</span><span class="n">only</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="p">.</span><span class="n">python</span><span class="o">-</span><span class="n">rundeps</span><span class="o">-</span><span class="mf">20210402.212232</span> <span class="n">noarch</span> <span class="p">{.</span><span class="n">python</span><span class="o">-</span><span class="n">rundeps</span><span class="p">}</span> <span class="p">()</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">ca</span><span class="o">-</span><span class="n">certificates</span><span class="o">-</span><span class="n">bundle</span><span class="o">-</span><span class="mi">20191127</span><span class="o">-</span><span class="n">r5</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">ca</span><span class="o">-</span><span class="n">certificates</span><span class="p">}</span> <span class="p">(</span><span class="n">MPL</span><span class="o">-</span><span class="mf">2.0</span> <span class="n">AND</span> <span class="n">MIT</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">libc</span><span class="o">-</span><span class="n">utils</span><span class="o">-</span><span class="mf">0.7</span><span class="p">.</span><span class="mi">2</span><span class="o">-</span><span class="n">r3</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">libc</span><span class="o">-</span><span class="n">dev</span><span class="p">}</span> <span class="p">(</span><span class="n">BSD</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="n">Clause</span> <span class="n">AND</span> <span class="n">BSD</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="n">Clause</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">libffi</span><span class="o">-</span><span class="mf">3.3</span><span class="o">-</span><span class="n">r2</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">libffi</span><span class="p">}</span> <span class="p">(</span><span class="n">MIT</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">libtls</span><span class="o">-</span><span class="n">standalone</span><span class="o">-</span><span class="mf">2.9</span><span class="p">.</span><span class="mi">1</span><span class="o">-</span><span class="n">r1</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">libtls</span><span class="o">-</span><span class="n">standalone</span><span class="p">}</span> <span class="p">(</span><span class="n">ISC</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">ssl_client</span><span class="o">-</span><span class="mf">1.32</span><span class="p">.</span><span class="mi">1</span><span class="o">-</span><span class="n">r5</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">busybox</span><span class="p">}</span> <span class="p">(</span><span class="n">GPL</span><span class="o">-</span><span class="mf">2.0</span><span class="o">-</span><span class="n">only</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">krb5</span><span class="o">-</span><span class="n">conf</span><span class="o">-</span><span class="mf">1.0</span><span class="o">-</span><span class="n">r2</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">krb5</span><span class="o">-</span><span class="n">conf</span><span class="p">}</span> <span class="p">(</span><span class="n">MIT</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">expat</span><span class="o">-</span><span class="mf">2.2</span><span class="p">.</span><span class="mi">10</span><span class="o">-</span><span class="n">r1</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">expat</span><span class="p">}</span> <span class="p">(</span><span class="n">MIT</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="n">libcrypto1</span><span class="p">.</span><span class="mi">1</span><span class="o">-</span><span class="mf">1.1</span><span class="p">.</span><span class="mi">1</span><span class="n">k</span><span class="o">-</span><span class="n">r0</span> <span class="n">x86_64</span> <span class="p">{</span><span class="n">openssl</span><span class="p">}</span> <span class="p">(</span><span class="n">OpenSSL</span><span class="p">)</span> <span class="p">[</span><span class="n">installed</span><span class="p">]</span>
<span class="o">/</span><span class="n">app</span> <span class="err">$</span> 
</pre></table></code></div></div><p><br /></p><h2 id="avoid-latest-tag">Avoid latest tag</h2><p>As we have seen that most docker images use base image of some sort by specifying the <strong>FROM</strong> command in the Dockerfile.</p><div class="language-markdown highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>FROM alpine:latest
</pre></table></code></div></div><p>The above command will pull the latest base image. It’s recommended to avoid pulling latest tag since the latest tag is rolling and the underlying image with the latest tag can be different in future which may break the dependency of our program and it also becomes hard to track the version of our base image that we pulled earlier. We should use the exact version instead.</p><div class="language-markdown highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>FROM python:3.9.1-alpine
</pre></table></code></div></div><p><br /></p><p>There are more such security measures which I am not covering in the blog post since it’ll be like spoiling <strong>The Offensive Labs’</strong> course and I neither want to steal the credit for his hard work and effort. So, Thank you all for giving your time to read this blog post. If you want to know more security measures and delve deeper into the topics, I would recommend you to get his course which is part of The Offensive Labs subscription.</p><h2 id="links-and-resources">Links and Resources</h2><p>https://theoffensivelabs.com/p/all-course-subscription-pack <br /> https://www.youtube.com/watch?v=-LeV_c1zG-s <br /> https://docs.docker.com/engine/install/debian/ <br /> https://www.theoffensivelabs.com/p/hacking-and-securing-docker-containers <br /></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/docker-build-security/'>Docker Build Security</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/pentesting/" class="post-tag no-text-decoration" >pentesting</a> <a href="/tags/hacking/" class="post-tag no-text-decoration" >hacking</a> <a href="/tags/docker/" class="post-tag no-text-decoration" >docker</a> <a href="/tags/docker-security/" class="post-tag no-text-decoration" >docker security</a> <a href="/tags/docker-build/" class="post-tag no-text-decoration" >docker build</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Docker Build Stage Security Best Practices - Dazzy Ddos&url=https://dazzyddos.github.io/posts/Docker-Build-Stage-Security-Best-Practices/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Docker Build Stage Security Best Practices - Dazzy Ddos&u=https://dazzyddos.github.io/posts/Docker-Build-Stage-Security-Best-Practices/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Docker Build Stage Security Best Practices - Dazzy Ddos&url=https://dazzyddos.github.io/posts/Docker-Build-Stage-Security-Best-Practices/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/(Un)Hooking,-COWs-and-Meow-Meow/">(Un)Hooking, COWs and Meow Meow</a><li><a href="/posts/Naughty_Hooking_Detoxifying_Memory/">Naughty Hooking Detoxifying Memory Before Doing Crime</a><li><a href="/posts/Remote-Process-Enumeration-with-WTS-Set-Of-APIs/">Remote Process Enumeration with WTS Set of Windows APIs</a><li><a href="/posts/AMSI-Bypass/">Defense Evasion Series Part 1 AMSI Bypass</a><li><a href="/posts/Automating-Phishing-Infrastructure-with-terraform-on-AWS/">Automating Phishing Infrastructure with terraform on AWS</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/pentesting/">pentesting</a> <a class="post-tag" href="/tags/hacking/">hacking</a> <a class="post-tag" href="/tags/frida/">frida</a> <a class="post-tag" href="/tags/hooking/">hooking</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/unhooking/">unhooking</a> <a class="post-tag" href="/tags/walkthrough/">walkthrough</a> <a class="post-tag" href="/tags/amsi-bypass/">amsi bypass</a> <a class="post-tag" href="/tags/av-bypass/">av bypass</a> <a class="post-tag" href="/tags/aws/">aws</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/TryHackMe-Ra-Walkthrough/"><div class="card-body"> <span class="timeago small" > Feb 20, 2021 <i class="unloaded">2021-02-20T08:10:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>TryHackMe Ra Walkthrough</h3><div class="text-muted small"><p> Ra is an awesome box from TryHackMe by @4nqr34z and @theart42. Port Scanning and Basic Enumeration As always, will start with full port scan. Will do the other enumeration alongside till the nmap...</p></div></div></a></div><div class="card"> <a href="/posts/TryHackMe-Enterprise-Walkthrough/"><div class="card-body"> <span class="timeago small" > Mar 22, 2021 <i class="unloaded">2021-03-22T08:10:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>TryHackMe Enterprise Walkthrough</h3><div class="text-muted small"><p> Enterprise is an awesome box from TryHackMe by @NekoS3c You just landed in an internal network. You scan the network and there’s only the Domain Controller… Enumeration As always, we’ll st...</p></div></div></a></div><div class="card"> <a href="/posts/Automating-Phishing-Infrastructure-with-terraform-on-AWS/"><div class="card-body"> <span class="timeago small" > Apr 30, 2021 <i class="unloaded">2021-04-30T14:10:00+03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Automating Phishing Infrastructure with terraform on AWS</h3><div class="text-muted small"><p> Introduction Hola, cariño readers. I hope you all are doing good and safe. In this blog post, I will walk you through creating an EC2 Instance on AWS and then installing and setting Gophish instan...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/TryHackMe-Enterprise-Walkthrough/" class="btn btn-outline-primary" prompt="Older"><p>TryHackMe Enterprise Walkthrough</p></a> <a href="/posts/Automating-Phishing-Infrastructure-with-terraform-on-AWS/" class="btn btn-outline-primary" prompt="Newer"><p>Automating Phishing Infrastructure with terraform on AWS</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/dazzyddos">dazzy</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/pentesting/">pentesting</a> <a class="post-tag" href="/tags/hacking/">hacking</a> <a class="post-tag" href="/tags/frida/">frida</a> <a class="post-tag" href="/tags/hooking/">hooking</a> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/unhooking/">unhooking</a> <a class="post-tag" href="/tags/walkthrough/">walkthrough</a> <a class="post-tag" href="/tags/amsi-bypass/">amsi bypass</a> <a class="post-tag" href="/tags/av-bypass/">av bypass</a> <a class="post-tag" href="/tags/aws/">aws</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://dazzyddos.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
